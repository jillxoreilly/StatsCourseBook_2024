

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Vacation Assignment &#8212; Introduction to Statistics and Data Science</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Chapter6_ttest/HandInAssignment_TutorNotes';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/dice.jpg" class="logo__image only-light" alt="Introduction to Statistics and Data Science - Home"/>
    <script>document.write(`<img src="../_static/dice.jpg" class="logo__image only-dark" alt="Introduction to Statistics and Data Science - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Preparation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter0_PrepWork/MT_wk0_intro.html">1. Preparatory Work</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter0_PrepWork/MT_wk0_datacamp.html">1.2. Datacamp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter0_PrepWork/MT_wk0_JupyterLab.html">1.3. Using Anaconda and JupyterLab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter0_PrepWork/MT_wk0_Colab.html">1.4. Using Google Colab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter0_PrepWork/MT_wk0_For.html">1.5. The FOR loop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter0_PrepWork/MT_wk0_ForIf.html">1.6. FOR loop with IF statement</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter0_PrepWork/MT_wk0_random.html">1.7. Simulating a random process</a></li>

<li class="toctree-l2"><a class="reference internal" href="../Chapter0_PrepWork/MT_wk0_ChatGPT.html">1.9. ChatGPT</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Exploring Data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter1_DescribingData/MT_wk1_intro.html">1. Describing Data</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter1_DescribingData/MT_wk1_outcomes.html">1.2. Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter1_DescribingData/MT_wk1_MeanMedianMode.html">1.3. Mean, median and mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter1_DescribingData/MT_wk1_StDevIQR.html">1.4. Standard Deviation and IQR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter1_DescribingData/MT_wk1_Skew.html">1.5. Skew</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter1_DescribingData/MT_wk1_Correlation.html">1.6. Correlation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter1_DescribingData/MT_wk1_conceptCheck.html">1.7. Concepts Review</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter1_DescribingData/MT_wk1_PythonIndexing.html">1.8. Python: Descriptives and Indexing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter1_DescribingData/MT_wk1_tables.html">1.9. Tables of descriptive statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter1_DescribingData/MT_wk1_TutorialExercises.html">1.10. Tutorial Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter2_DataVisualization/MT_wk2_intro.html">2. Data Visualization</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter2_DataVisualization/MT_wk2_outcomes.html">2.2. Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter2_DataVisualization/MT_wk2_snsplt.html">2.3. <code class="docutils literal notranslate"><span class="pre">Seaborn</span></code> and <code class="docutils literal notranslate"><span class="pre">Matplotlib</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter2_DataVisualization/MT_wk2_histogram.html">2.4. Visualizing Distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter2_DataVisualization/MT_wk2_boxplot.html">2.5. Comparing Categories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter2_DataVisualization/MT_wk2_scatterplot.html">2.6. 2D Data: Correlation and Pairwise Effects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter2_DataVisualization/MT_wk2_lineplot.html">2.7. Timeseries data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter2_DataVisualization/MT_wk2_tweaks.html">2.8. Tweaking plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter2_DataVisualization/MT_wk2_TutorialExercises.html">2.9. Tutorial Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter3_DataWrangling/MT_wk3_intro.html">3. Data Wrangling</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter3_DataWrangling/MT_wk3_outcomes.html">3.2. Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter3_DataWrangling/MT_wk3_FindOutliers.html">3.3. Locating bad datapoints</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter3_DataWrangling/MT_wk3_NaNing.html">3.4. Neutralizing bad datapoints</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter3_DataWrangling/MT_wk3_NanHandling.html">3.5. Handling NaNs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter3_DataWrangling/MT_wk3_disaggregation.html">3.6. Data Disaggregation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter3_DataWrangling/MT_wk3_CreateColumns.html">3.7. Creating new variables/columns</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter3_DataWrangling/MT_wk3_ZScoreQuantiles.html">3.8. Standardizing data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter3_DataWrangling/MT_wk3_ReportExample.html">3.9. Preparing a report</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter3_DataWrangling/MT_wk3_Assignment1_ModelAnswer.html">3.10. Model Client Report</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter3_DataWrangling/MT_wk3_TutorialExercises.html">3.11. Tutorial Exercises</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Hypothesis Testing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter4_PermutationTest/MT_wk5_permutation_intro.html">1. Permutation Testing</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter4_PermutationTest/MT_wk5_permutation_outcomes.html">1.2. Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter4_PermutationTest/MT_wk5_HypothesisTesting.html">1.3. Hypothesis testing concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter4_PermutationTest/MT_wk5_OneTwoTail.html">1.4. One- and two-tailed tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter4_PermutationTest/MT_wk5_PermutationTypes.html">1.5. Permutation testing overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter4_PermutationTest/MT_wk5_functions.html">1.6. Python Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter4_PermutationTest/MT_wk5_permutation_paired.html">1.7. Permutation test for paired data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter4_PermutationTest/MT_wk5_permutation_unpaired.html">1.8. Permutation test for unpaired or independent samples data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter4_PermutationTest/MT_wk5_permutation_correlation.html">1.9. Permutation test for correlation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter4_PermutationTest/MT_wk5_permutation_practice.html">1.10. Permutation testing - more practice</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter4_PermutationTest/MT_wk5_permutation_TutorialExercises.html">1.11. Tutorial exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter5_ClassicTests/MT_wk6_classictests_intro.html">2. Rank-Based Tests</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter5_ClassicTests/MT_wk6_outcomes.html">2.3. Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter5_ClassicTests/MT_wk6_nonpara_intro.html">2.4. Rank-based tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter5_ClassicTests/MT_wk6_nonpara_MannWhitneyU.html">2.5. Rank Sum Test</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter5_ClassicTests/MT_wk6_nonpara_WilcoxonSignRank.html">2.6. The Wilcoxon Sign-Rank Test</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter5_ClassicTests/MT_wk6_spearman.html">2.7. Spearman’s Rank Correlation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter5_ClassicTests/MT_wk6_TutorialExercises.html">2.8. Tutorial Exercises: non-parametric tests</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="ttest_intro.html">3. t-Test</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="HypothesisTestingRecap.html">3.2. Hypothesis testing roundup</a></li>
<li class="toctree-l2"><a class="reference internal" href="NormalDistribution.html">3.3. Normal Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="BestFittingNormal.html">3.4. Best fitting Normal</a></li>
<li class="toctree-l2"><a class="reference internal" href="tDistribution.html">3.5. The t distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="ttest_oneSample.html">3.6. One sample t-test</a></li>
<li class="toctree-l2"><a class="reference internal" href="ttest_pairedSamples.html">3.7. Paired Samples t-test</a></li>
<li class="toctree-l2"><a class="reference internal" href="ttest_independentSamples.html">3.8. Independent samples t-test</a></li>
<li class="toctree-l2"><a class="reference internal" href="HandInAssignment.html">3.9. Vacation Assignment</a></li>

</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter7_Power/power_intro.html">4. Power analysis</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter7_Power/power_outcomes.html">4.2. Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter7_Power/Type1and2Errors.html">4.3. False positives and False negatives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter7_Power/EffectSize.html">4.4. Effect size (Cohen’s d)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter7_Power/EffectSizeCorrelation.html">4.5. Effect size (Pearson’s r)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter7_Power/PowerCorrelationSim.html">4.6. Power analysis by simulation</a></li>

<li class="toctree-l2"><a class="reference internal" href="../Chapter7_Power/BuiltInPowerCalc.html">4.8. Power analysis with <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter7_Power/DeterminingEffectSize.html">4.9. Knowing the effect size</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter7_Power/SampleSizeAndPower.html">4.10. Sample size and power</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter7_Power/power_conceptCheck.html">4.11. Concepts Review</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter7_Power/TutorialExercises.html">4.12. Tutorial Exercises</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Statistical Theory</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter8_DataGeneratingDistributions/binomial_overallIntro.html">1. Data generating distributions</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter8_DataGeneratingDistributions/binomial_intro.html">1.1. The Binomial Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter8_DataGeneratingDistributions/binomial_objectives.html">1.2. Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter8_DataGeneratingDistributions/binomial_singlecoin.html">1.3. Simulated coin toss</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter8_DataGeneratingDistributions/binomial_10000reps.html">1.4. Repeat the simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter8_DataGeneratingDistributions/binomial_nandp.html">1.5. Changing <span class="math notranslate nohighlight">\(n\)</span> and <span class="math notranslate nohighlight">\(p\)</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter8_DataGeneratingDistributions/binomial_PMFandCDF.html">1.6. Binomial PMF and CDF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter8_DataGeneratingDistributions/AnalyticVsNumerical.html">1.7. Analytical vs numerical approaches</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter8_DataGeneratingDistributions/binomial_normal.html">1.8. Normal distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter8_DataGeneratingDistributions/TutorialExercises.html">1.9. Tutorial Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter8_DataGeneratingDistributions/CentralLimitTheorem.html">1.10. Extension Work - Central Limit Theorem (reading)</a></li>

<li class="toctree-l2"><a class="reference internal" href="../Chapter8_DataGeneratingDistributions/TutorialExercises_CentralLimitTheorem.html">1.12. Extension Work: The Central Limit Theorem (Exercises)</a></li>


</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter9_Probability/Probability_intro.html">2. Probability</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter9_Probability/KolmogorovAxioms.html">2.1. Kolmogorov Axioms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter9_Probability/Diagrams.html">2.2. Probability Diagrams</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter9_Probability/Independence.html">2.3. Statsitical Independence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter9_Probability/EventCombinations.html">2.4. Event combinations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter9_Probability/BayesTheorem.html">2.5. Bayes Theorem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter9_Probability/PaperAndPencilExercises.html">2.6. Exercises: paper and pencil</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter9_Probability/TutorialExercises1.html">2.7. Tutorial Exercises 1: Probability Jargon in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter9_Probability/TutorialExercises2.html">2.8. Tutorial Exercises 2: Rolling a Six</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter9_Probability/placeholder.html">2.9. Hand In Assignment</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Regression Models</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter10_Regression1/regression1_intro.html">1. Regression</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter10_Regression1/regression1_outcomes.html">1.1. Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter10_Regression1/regression1_concepts.html">1.2. Regression Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter10_Regression1/regression1_interpretingSlope.html">1.3. Interpreting the slope and intercept, prediction and residuals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter10_Regression1/regression1_QandA.html">1.4. Regression, Covariance and Correlation Q&amp;A</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter10_Regression1/regression1_prepwork.html">1.5. Regression models in Python</a></li>

<li class="toctree-l2"><a class="reference internal" href="../Chapter10_Regression1/regression1_TutorialExercises.html">1.7. Tutorial Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter11_Regression2/regression2_intro.html">2. Multivariate Analysis</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter11_Regression2/regression2_concepts.html">2.2. Multivariate Analysis Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter11_Regression2/regression2_typesOfRelationship.html">2.3. Different types of multivariate relationship</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter11_Regression2/regression2_QandA.html">2.4. Multiple Regression Q &amp; A</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter11_Regression2/regression2_TutorialExercises.html">2.5. Tutorial Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter12_Regression3/regression3_intro.html">3. Regression - Statistical Tests</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter12_Regression3/regression3_outcomes.html">3.2. Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter12_Regression3/regression3_conceptsR2.html">3.3. Model fit: <span class="math notranslate nohighlight">\(R^2\)</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter12_Regression3/regression3_conceptsConditionals.html">3.4. Conditional Distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter12_Regression3/regression3_conceptsSignificance.html">3.5. Statistical Significance in Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter12_Regression3/regression3_assumptions.html">3.6. Assumptions in Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter12_Regression3/regression3_prepwork.html">3.7. Assessing Regression models in Python.</a></li>

<li class="toctree-l2"><a class="reference internal" href="../Chapter12_Regression3/regression3_TutorialExercises.html">3.9. Tutorial Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter13_Regression4/regression4_intro.html">4. ANOVA</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter13_Regression4/regression4_outcomes.html">4.2. Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter13_Regression4/regression4_concepts.html">4.3. ANOVA Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter13_Regression4/regression4_longhandExample.html">4.4. Longhand calculation example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter13_Regression4/regression4_equations.html">4.5. ANOVA Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter13_Regression4/regression4_KWtest.html">4.6. Kruskall-Wallis test</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter13_Regression4/regression4_ANOVAregression.html">4.7. ANOVA versus Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter13_Regression4/regression4_prepwork.html">4.8. ANOVA and Kruskal-Wallis in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter13_Regression4/regression4_TutorialExercises.html">4.9. Tutorial exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter14_Regression5/regression5_intro.html">5. Logistic Regression</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter14_Regression5/regression5_outcomes.html">5.2. Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter14_Regression5/regression5_concepts.html">5.3. Odds, logs and log odds</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter14_Regression5/regression5_LogisticEquation.html">5.4. Logistic Regression Equation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter14_Regression5/regression5_workedExample.html">5.5. Predicted probabilities (worked example)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter14_Regression5/regression5_prepwork.html">5.6. Logistic Regression in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter14_Regression5/regression5_TutorialExercises.html">5.7. Tutorial exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter15_Regression6/regression6_intro.html">6. Research Design</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-16"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter15_Regression6/regression6_outcomes.html">6.2. Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter15_Regression6/regression6_concepts.html">6.3. Research Design Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter15_Regression6/regression6_causality.html">6.4. Causality</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter15_Regression6/regression6_TutorialExercises.html">6.5. Tutorial exercises</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/jillxoreilly/StatsCourseBook_2024/blob/master/Chapter6_ttest/HandInAssignment_TutorNotes.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/jillxoreilly/StatsCourseBook_2024" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/jillxoreilly/StatsCourseBook_2024/issues/new?title=Issue%20on%20page%20%2FChapter6_ttest/HandInAssignment_TutorNotes.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Chapter6_ttest/HandInAssignment_TutorNotes.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Vacation Assignment</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Vacation Assignment</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#part-1-data-analysis-exercises">Part 1 - data analysis exercises</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-cloud-seeding">Question 1 - Cloud seeding</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-red-i-independent-samples-t-test"><font color="red">I. Independent samples t-test</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-red-ii-permutation-test-for-difference-of-means-independent-samples"><font color="red">II. Permutation test for difference of means (independent samples)</font></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#question-2-colouring-books">Question 2: Colouring books</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-red-i-paired-samples-t-test"><font color="red">I. Paired samples t-test</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-red-ii-permutation-test-for-difference-of-means-paired-samples"><font color="red">II. Permutation test for difference of means: paired samples</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-red-iii-sign-rank-test"><font color="red">III. Sign rank test</font></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#question-3-reaction-times">Question 3: Reaction times</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-2-more-revision">Part 2 - More Revision</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#long-vs-wideform-data">Long vs wideform data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#experimental-design">Experimental design</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#one-vs-two-tailed-tests">One vs Two-tailed tests</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="vacation-assignment">
<h1>Vacation Assignment<a class="headerlink" href="#vacation-assignment" title="Permalink to this heading">#</a></h1>
<p>This assignment has two parts.</p>
<p>In the first part you carry out some hypothesis tests; this is designed for you to practice both the process of running the different tests, and to make sure you understand the choices you are making when running tests.</p>
<p>The second part, ‘revision’, targets some Python syntax and (mainly) some concepts that I want to make sure everyone has securely grasped. The answers to all conceptual questions can be found in the lectures and reading; searching for them is good revision!</p>
<p>Overall, the idea of this assignment is to help you consolidate what you learned this term and it should prepare you well for the collection in January. Please remember that searching for the answers (in the lecture notes etc) and trying things til it works (for coding) is part of the learning process; you are <em>supposed</em> to need to do that rather than having all the answers at your fingertips.</p>
<p><font color='red'>This can be distributed to students as a model answer but not until 1st week of HT please, as some tutors will set a hand-in deadline in 0th week (including me!)</p>
<p><font color='red'>The exercises are quite long so please do feel free to give students the model answer rather than correcting each question part on their script as this will be very long winded for you as markers. You can then give some overall feedback/ detailed comments on any ‘thoughtful’ parts as think useful, or give verbal feedback</p>
<p><font color='red'>Students should be able to complete all the ‘revision’ questions by revising the lectures and reading from the term. It will be more effective as revision if they need to find the answers by themselves, so I suggest leaving them to tackle these over the vacation.</p>
<p><font color='red'>The data analysis questions recap the process for t-test, permutation test and rank-based test, with some ‘thinking’ questions thrown in. The student could make a start on these in the tutorial.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set-up Python libraries - you need to run this but you don&#39;t need to change it</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">stats</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="part-1-data-analysis-exercises">
<h1>Part 1 - data analysis exercises<a class="headerlink" href="#part-1-data-analysis-exercises" title="Permalink to this heading">#</a></h1>
<p>In these questions you need to carry out various statistical tests. Please read the questions carefully and answer all parts - in particular if you are asked to <em>comment</em> on your results you must comment; this usually means interpret the results in plain English.</p>
<section id="question-1-cloud-seeding">
<h2>Question 1 - Cloud seeding<a class="headerlink" href="#question-1-cloud-seeding" title="Permalink to this heading">#</a></h2>
<p><strong>a)  Download the data file and load the data into a <code class="docutils literal notranslate"><span class="pre">Pandas</span></code> dataframe called <code class="docutils literal notranslate"><span class="pre">clouds</span></code></strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clouds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/jillxoreilly/StatsCourseBook_2024/main/data/cloudSeeding.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>b) Plot the data for seeded and unseeded clouds in a way that shows the distribution of rainfall yields</strong></p>
<p><font color='red'>I chose a KDE plot to show the distribution (for example the long positive tail is clearly seen), and plotted individual data points as the sample is small; for example we can see that the long positive tail is based on just a couple of clouds in each case.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">clouds</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;rainfall&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;status&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">rugplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">clouds</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;rainfall&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;status&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6f959d406047d04abb5bba1e2aaa45d1c56ded3b203e753b3348fafc6ba4f18b.png" src="../_images/6f959d406047d04abb5bba1e2aaa45d1c56ded3b203e753b3348fafc6ba4f18b.png" />
</div>
</div>
<p><strong>c) Calculate the parameters of the best fitting Normal distributions for seeded and unseeded clouds respectively</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
<span class="n">clouds</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="8" halign="left">rainfall</th>
    </tr>
    <tr>
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>status</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Seeded</th>
      <td>26.0</td>
      <td>441.984615</td>
      <td>650.787171</td>
      <td>4.1</td>
      <td>98.125</td>
      <td>221.6</td>
      <td>406.025</td>
      <td>2745.6</td>
    </tr>
    <tr>
      <th>Unseeded</th>
      <td>26.0</td>
      <td>164.588462</td>
      <td>278.426404</td>
      <td>1.0</td>
      <td>24.825</td>
      <td>44.2</td>
      <td>159.200</td>
      <td>1202.6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><em>State the parameters here</em></p>
<p><font color='red'>Your answer here</p>
<ul class="simple">
<li><p><font color='red'>For seeded clouds, the mean is 442 mm and the sd is 651mm</p></li>
<li><p><font color='red'>For unseeded clouds, the mean is 164 mm and the sd is 278mm</font></p></li>
</ul>
<p><strong>d) Is a normal distribution a good fit to the data?</strong></p>
<p><em>The here we overlay the best fitting normal on the data KDE plot:</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">seeded</span><span class="o">=</span><span class="n">clouds</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;status==&quot;Seeded&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rainfall</span>
<span class="n">unseeded</span><span class="o">=</span><span class="n">clouds</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;status==&quot;Unseeded&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rainfall</span>

<span class="c1"># seeded clouds</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span><span class="mi">4000</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">seeded</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="n">seeded</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">seeded</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">rugplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">seeded</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.0022</span><span class="p">])</span>

<span class="c1"># unseeded clouds</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">x</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span><span class="mi">4000</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">unseeded</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="n">seeded</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">unseeded</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">rugplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">unseeded</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.0022</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/0611d459e8f5f84fa821697996f5e2ced669abae67c0acd218f2566f5a96a54d.png" src="../_images/0611d459e8f5f84fa821697996f5e2ced669abae67c0acd218f2566f5a96a54d.png" />
</div>
</div>
<p><em>Based on the plot above, the data are not well fitted by a normal distribution. Comment on the what you can see in the graph that suggests the normal distribution is a poor fit.</em></p>
<p><font color='red'>Your answer here</p>
<p><font color='red'>The mean of the fitted normal seems to fall above almost all the datapoints in each sample.</p>
<p><font color='red'>The long tail of high rainfall events (positive skew) is not fitted by the normal which is necessarily symetrical</p>
<p><font color='red'>The best fitting normal assigns a lot of probability mass to rainfall values below zero (to be fair the KDE plot also does this!)</p>
<p><strong>e) Conduct three statistical tests of the researcher’s hypothesis, based on:</strong></p>
<p><em>I.	Assumption of normality</em></p>
<p><em>II.	Permutation</em></p>
<p><em>III.	Ranked values</em></p>
<p><em>… in each case you should:</em></p>
<ul class="simple">
<li><p>State the null and alternative hypothesis and the alpha value</p></li>
<li><p>Report appropriate descriptive statistics for the test in question</p></li>
<li><p>Carry out the test</p></li>
<li><p>State the results of the test including the test statistic and p value. For the t-test, degrees of freedom should also be stated.</p></li>
<li><p>Report your practical conclusion in plain English</p></li>
</ul>
<section id="font-color-red-i-independent-samples-t-test">
<h3><font color='red'>I. Independent samples t-test<a class="headerlink" href="#font-color-red-i-independent-samples-t-test" title="Permalink to this heading">#</a></h3>
<p><font color='red'><span class="math notranslate nohighlight">\(\mathcal{H_o}:\)</span> There is no difference in mean rainfall between seeded and unseeded clouds</p>
<p><font color='red'><span class="math notranslate nohighlight">\(\mathcal{H_a}:\)</span> The mean rainfall is higher for seeded clouds</p>
<p><font color='red'>I will test at the 5% level, one tailed</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># output the relevant descriptive statistics</span>
<span class="n">clouds</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;rainfall&#39;</span><span class="p">:[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">]})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="3" halign="left">rainfall</th>
    </tr>
    <tr>
      <th></th>
      <th>mean</th>
      <th>std</th>
      <th>count</th>
    </tr>
    <tr>
      <th>status</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Seeded</th>
      <td>441.984615</td>
      <td>650.787171</td>
      <td>26</td>
    </tr>
    <tr>
      <th>Unseeded</th>
      <td>164.588462</td>
      <td>278.426404</td>
      <td>26</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><font color='red'> The mean rainfall is higher for seeded clouds (mean = 441.98 standard units, s.d. = 650.78) than for unseeded clouds (mean = 164.59 standard units, s.d. = 278.42)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">seeded</span><span class="p">,</span><span class="n">unseeded</span><span class="p">,</span><span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;greater&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TtestResult(statistic=1.9982446280649688, pvalue=0.025571601199239034, df=50.0)
</pre></div>
</div>
</div>
</div>
<p><font color='red'>Rainfall was significantly higher for seeded clouds (t(50)=2.00, p=0.0256 one-tailed).</p>
<p><font color='red'>We conclude that cloud seeding increases rainfall.</p>
</section>
<section id="font-color-red-ii-permutation-test-for-difference-of-means-independent-samples">
<h3><font color='red'>II. Permutation test for difference of means (independent samples)<a class="headerlink" href="#font-color-red-ii-permutation-test-for-difference-of-means-independent-samples" title="Permalink to this heading">#</a></h3>
<p><font color='red'><span class="math notranslate nohighlight">\(\mathcal{H_o}:\)</span> There is no difference in mean rainfall between seeded and unseeded clouds</p>
<p><font color='red'><span class="math notranslate nohighlight">\(\mathcal{H_a}:\)</span> The mean rainfall is higher for seeded clouds</p>
<p><font color='red'>I will test at the 5% level, one tailed</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># output the relevant descriptive statistics</span>
<span class="n">clouds</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;rainfall&#39;</span><span class="p">:[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">]})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="3" halign="left">rainfall</th>
    </tr>
    <tr>
      <th></th>
      <th>mean</th>
      <th>std</th>
      <th>count</th>
    </tr>
    <tr>
      <th>status</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Seeded</th>
      <td>441.984615</td>
      <td>650.787171</td>
      <td>26</td>
    </tr>
    <tr>
      <th>Unseeded</th>
      <td>164.588462</td>
      <td>278.426404</td>
      <td>26</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><font color='red'>The mean rainfall is higher for seeded clouds (mean = 441.98 standard units, s.d. = 650.78) than for unseeded clouds (mean = 164.59 standard units, s.d. = 278.42)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define a function for difference of means in the suitalbe formmat for stats.permutation_test()</span>
<span class="c1"># note the difference between this function and mDiff for paired samples below!</span>
<span class="k">def</span> <span class="nf">dMeans</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="n">stats</span><span class="o">.</span><span class="n">permutation_test</span><span class="p">((</span><span class="n">seeded</span><span class="p">,</span><span class="n">unseeded</span><span class="p">),</span><span class="n">dMeans</span><span class="p">,</span><span class="n">permutation_type</span><span class="o">=</span><span class="s1">&#39;independent&#39;</span><span class="p">,</span><span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;greater&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PermutationTestResult(statistic=277.3961538461539, pvalue=0.0189, null_distribution=array([-142.19615385,  108.55769231,    6.75769231, ..., -115.31923077,
        184.41153846, -224.15769231]))
</pre></div>
</div>
</div>
</div>
<p><font color='red'>Rainfall was significantly higher for seeded clouds (difference of means = 277.40, df = 50, p=0.0206 one-tailed).</p>
<p><font color='red'>We conclude that cloud seeding increases rainfall.</p>
<p><font color='red'>Note - the degrees of freedom for this test are 50 (52 datapoints - 2 estimated means for each shuffle; However I don’t necessarily expect students to work this out as I haven’t really explained it; it would be fine to just report sample sizes instead for the permutation test)</p>
<p><font color='red'>III. Rank sum test</p>
<p><font color='red'><span class="math notranslate nohighlight">\(\mathcal{H_o}:\)</span> There is no difference in median rainfall between seeded and unseeded clouds</p>
<p><font color='red'><span class="math notranslate nohighlight">\(\mathcal{H_a}:\)</span> The median rainfall is higher for seeded clouds</p>
<p><font color='red'>I will test at the 5% level, one tailed</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># output the relevant descriptive statistics</span>
<span class="n">clouds</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">quantile</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.75</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>rainfall</th>
    </tr>
    <tr>
      <th>status</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">Seeded</th>
      <th>0.25</th>
      <td>98.125</td>
    </tr>
    <tr>
      <th>0.50</th>
      <td>221.600</td>
    </tr>
    <tr>
      <th>0.75</th>
      <td>406.025</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Unseeded</th>
      <th>0.25</th>
      <td>24.825</td>
    </tr>
    <tr>
      <th>0.50</th>
      <td>44.200</td>
    </tr>
    <tr>
      <th>0.75</th>
      <td>159.200</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><font color='red'>The median rainfall is higher for seeded clouds (median = 221.60 standard units, q1=98.13, q3=406.03) than for unseeded clouds (median = 44.20 standard units, q1=24.825, q3=159.20)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span><span class="o">.</span><span class="n">mannwhitneyu</span><span class="p">(</span><span class="n">seeded</span><span class="p">,</span><span class="n">unseeded</span><span class="p">,</span><span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;greater&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MannwhitneyuResult(statistic=473.0, pvalue=0.0069156486351175175)
</pre></div>
</div>
</div>
</div>
<p><font color='red'>A rank sum test shows that the median rainfall is significantly higher for seeded clouds (R=473.0, n1,n2=26, p=0.00692)</p>
<p><font color='red'>We conclude that cloud seeding does indeed increase rainfall</p>
<p><font color='red'>Note - I think students should report the sample sizes for rank based tests so that the reader knows how many data points the inference was based on, and also because the test statistic R is uninterpretable without the sample sizes; some stats packages convert the test statistic R to a Z score which would be nice but statsmodels doesn’t do that.</p>
<p><strong>f) Comment on the relative merits of each possible choice of test for this dataset.</strong></p>
<p><font color='red'> Your answer here</p>
<p><font color='red'>I would choose the permutation test. The t-test is clearly not appropriate due to the non-normal data distribution. Ranking of the data downplays the role of the extreme rainfall events which, though rare, are of significant practical importance.</p>
<p><font color='red'>Note - Students may prefer the rank sum test ot permutation, for example if they regard the extreme rainfall events as outliers not to be trusted. I am fine with that answer as long as coherently justified.</p>
</section>
</section>
<section id="question-2-colouring-books">
<h2>Question 2: Colouring books<a class="headerlink" href="#question-2-colouring-books" title="Permalink to this heading">#</a></h2>
<p>A researcher hypothesises that working on adult colouring books is particularly relaxing and will lower resting heart rate.</p>
<p>She measures resting heart rate after one hour of colouring and after one hour of reading a novel in the same participants. The data are provided in the file ColouringHeartRate.csv. These are made-up data.</p>
<p>Download the data file and load the data into a Pandas dataframe called heartRate:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">heartRate</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/jillxoreilly/StatsCourseBook_2024/main/data/ColouringHeartRate.csv&#39;</span><span class="p">)</span>
<span class="n">heartRate</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>participantID</th>
      <th>colouring</th>
      <th>reading</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a</td>
      <td>62</td>
      <td>71</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b</td>
      <td>66</td>
      <td>71</td>
    </tr>
    <tr>
      <th>2</th>
      <td>c</td>
      <td>61</td>
      <td>69</td>
    </tr>
    <tr>
      <th>3</th>
      <td>d</td>
      <td>68</td>
      <td>61</td>
    </tr>
    <tr>
      <th>4</th>
      <td>e</td>
      <td>74</td>
      <td>75</td>
    </tr>
    <tr>
      <th>5</th>
      <td>f</td>
      <td>62</td>
      <td>71</td>
    </tr>
    <tr>
      <th>6</th>
      <td>g</td>
      <td>68</td>
      <td>77</td>
    </tr>
    <tr>
      <th>7</th>
      <td>h</td>
      <td>62</td>
      <td>72</td>
    </tr>
    <tr>
      <th>8</th>
      <td>i</td>
      <td>55</td>
      <td>62</td>
    </tr>
    <tr>
      <th>9</th>
      <td>j</td>
      <td>59</td>
      <td>65</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>b) Plot the data and comment.</strong></p>
<p><font color='red'> As the data are paired I will make a scatterplot; I plot the line x=y for reference</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">heartRate</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;reading&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;colouring&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">60</span><span class="p">,</span><span class="mi">75</span><span class="p">],[</span><span class="mi">60</span><span class="p">,</span><span class="mi">75</span><span class="p">],</span><span class="s1">&#39;r--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8cb24c2b4725b36275f06c8341ff1ca09c4fef0fe48e0b59843f43dc9ca1042a.png" src="../_images/8cb24c2b4725b36275f06c8341ff1ca09c4fef0fe48e0b59843f43dc9ca1042a.png" />
</div>
</div>
<p><font color='red'> Your comments here!</p>
<ul class="simple">
<li><p><font color='red'>There appears to be a positive correlation (people with high heart rates in one condition also have high heart rates in the other condition)</p></li>
<li><p><font color='red'> Almost all the participants have a higher heart rate in the reading condition (points lie above the line x=y)</p></li>
<li><p><font color='red'> Those with the highest heart raates in the control condition (reading) show the bibggest fall in heart rate in the colouring condition - perhaps those withh low heart rate sin the control condition are subject to a floor effect (heart rate cannot fall much lower; thehy are already relaxed!)</p></li>
<li><p><font color='red'> There are not many data points!</p></li>
</ul>
<p><strong>c)	This is a within-subjects or repeated-measures design. With reference to your graph, explain the advantages of a within-subjects design in this particular experiment.</strong></p>
<p><font color='red'>A within subjects design is one in which each participant completes multiple conditions, so each person can be compared to themself across conditions. The advantage is that all interpersonal confounding variables are cancelled out.</p>
<p><font color='red'>In the current study, we see that there are large idividual differences in heart rate, meaning that people with high heart rate in the colouring condition also have a high heart rate in the reading condition; the change in heart rate between conditions is relatively small an could be dwarfed by these individual differences in a between-subjects design.</p>
<p><font color='red'>A possible disadvantage is order effects - in the current example, if the colouring condition is always completed second, people could have a lower heart rate due to being more relaxed on the second visit to the lab.</p>
<p><strong>d) Control condition</strong></p>
<ul class="simple">
<li><p>Why do you think the researcher chose to compare heart rate after one hour of colouring to heart rate after one hour of reading, as opposed to comparing heart rate before and after colouring?*</p></li>
</ul>
<p><font color='red'>Your answer here</p>
<p><font color='red'> To avoid order effects within a session - eg heart rate likely to be higher when the participant just arrived (from walking/cycling, plus possible nerves in the lab situation) than at the end of the session.</p>
<p><strong>e)	Conduct three statistical tests of the researcher’s hypothesis, based on</strong></p>
<p><em>I.	Assumption of normality</em></p>
<p><em>II.	Permutation</em></p>
<p><em>III.	Ranked values</em></p>
<p><em>… in each case you should:</em></p>
<ul class="simple">
<li><p>State the null and alternative hypothesis and the alpha value</p></li>
<li><p>Report appropriate descriptive statistics for the test in question</p></li>
<li><p>Carry out the test</p></li>
<li><p>State the results of the test including the test statistic and p value. For the t-test, degrees of freedom should also be stated.</p></li>
<li><p>Report your practical conclusion in plain English</p></li>
</ul>
<section id="font-color-red-i-paired-samples-t-test">
<h3><font color='red'>I. Paired samples t-test<a class="headerlink" href="#font-color-red-i-paired-samples-t-test" title="Permalink to this heading">#</a></h3>
<p><font color='red'><span class="math notranslate nohighlight">\(\mathcal{H_o}:\)</span> There is no difference in mean heart rate between reading and colouring conditions</p>
<p><font color='red'><span class="math notranslate nohighlight">\(\mathcal{H_a}:\)</span> The mean heartrate is lower in the colouring condition</p>
<p><font color='red'>I will test at the 5% level, one tailed</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># output the relevant descriptive statistics</span>
<span class="n">heartRate</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;colouring&#39;</span><span class="p">:[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">],</span> <span class="s1">&#39;reading&#39;</span><span class="p">:[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">]})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>colouring</th>
      <th>reading</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>mean</th>
      <td>63.700000</td>
      <td>69.40000</td>
    </tr>
    <tr>
      <th>std</th>
      <td>5.396501</td>
      <td>5.25357</td>
    </tr>
    <tr>
      <th>count</th>
      <td>10.000000</td>
      <td>10.00000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><font color='red'>The mean heart rate is lower after colouring (mean = 67.3 bpm, s.d. = 5.40) than after reading (mean = 69.4 bpm, s.d. = 5.25)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_rel</span><span class="p">(</span><span class="n">heartRate</span><span class="p">[</span><span class="s1">&#39;reading&#39;</span><span class="p">],</span> <span class="n">heartRate</span><span class="p">[</span><span class="s1">&#39;colouring&#39;</span><span class="p">],</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;greater&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TtestResult(statistic=3.4753513368432465, pvalue=0.0034947821057590726, df=9)
</pre></div>
</div>
</div>
</div>
<p><font color='red'>A paired samples t-test showed that there was a significant difference such that heart rate was lower after colouring than reading (t(9)=3.48, p=0.00349)</p>
<p><font color='red'>We conclude that colouring is a successful intervention to lower heart rate, compared to reading.</p>
</section>
<section id="font-color-red-ii-permutation-test-for-difference-of-means-paired-samples">
<h3><font color='red'>II. Permutation test for difference of means: paired samples<a class="headerlink" href="#font-color-red-ii-permutation-test-for-difference-of-means-paired-samples" title="Permalink to this heading">#</a></h3>
<p><font color='red'><span class="math notranslate nohighlight">\(\mathcal{H_o}:\)</span> There is no difference in mean heart rate between reading and colouring conditions</p>
<p><font color='red'><span class="math notranslate nohighlight">\(\mathcal{H_a}:\)</span> The mean heartrate is lower in the colouring condition</p>
<p><font color='red'>I will test at the 5% level, one tailed</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># output the relevant descriptive statistics</span>
<span class="n">heartRate</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;colouring&#39;</span><span class="p">:[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">],</span> <span class="s1">&#39;reading&#39;</span><span class="p">:[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">]})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>colouring</th>
      <th>reading</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>mean</th>
      <td>63.700000</td>
      <td>69.40000</td>
    </tr>
    <tr>
      <th>std</th>
      <td>5.396501</td>
      <td>5.25357</td>
    </tr>
    <tr>
      <th>count</th>
      <td>10.000000</td>
      <td>10.00000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><font color='red'>The mean heart rate is lower after colouring (mean = 67.3 bpm, s.d. = 5.40) than after reading (mean = 69.4 bpm, s.d. = 5.25)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># note the difference between this function and dMeans for independent sammples above!)</span>
<span class="k">def</span> <span class="nf">mDiff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">)</span>

<span class="n">stats</span><span class="o">.</span><span class="n">permutation_test</span><span class="p">((</span><span class="n">heartRate</span><span class="o">.</span><span class="n">reading</span><span class="p">,</span> <span class="n">heartRate</span><span class="o">.</span><span class="n">colouring</span><span class="p">),</span> <span class="n">mDiff</span><span class="p">,</span> <span class="n">permutation_type</span><span class="o">=</span><span class="s1">&#39;samples&#39;</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;greater&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PermutationTestResult(statistic=5.7, pvalue=0.0078125, null_distribution=array([ 5.7,  4.5,  4.3, ..., -4.3, -4.5, -5.7]))
</pre></div>
</div>
</div>
</div>
<p><font color='red'>A permutation test for paired samples showed a significant difference of means such that heart rate was lower after colouring than reading (mean difference in heart rate 5.7 bpm, p=0.0000781, df = 9).</p>
<p><font color='red'>Note - the degrees of freedom for this test are 9 (10 pairs - 1 mean difference for each shuffle); However I don’t necessarily expect students to work this out as I haven’t really explained it; it would be fine to just report sample sizes instead for the permutation test). However students should be aware that the relevant sample size here for statistical purposes is 10 (number of pairs) not 20 (number of measurements).</p>
</section>
<section id="font-color-red-iii-sign-rank-test">
<h3><font color='red'>III. Sign rank test<a class="headerlink" href="#font-color-red-iii-sign-rank-test" title="Permalink to this heading">#</a></h3>
<p><font color='red'><span class="math notranslate nohighlight">\(\mathcal{H_o}:\)</span> There is no difference in median heart rate between reading and colouring conditions</p>
<p><font color='red'><span class="math notranslate nohighlight">\(\mathcal{H_a}:\)</span> The median heartrate is lower in the colouring condition</p>
<p><font color='red'>I will test at the 5% level, one tailed</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># output the relevant descriptive statistics</span>
<span class="n">heartRate</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="p">[</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.75</span><span class="p">],</span> <span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>colouring</th>
      <th>reading</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0.25</th>
      <td>61.25</td>
      <td>66.00</td>
    </tr>
    <tr>
      <th>0.50</th>
      <td>62.00</td>
      <td>71.00</td>
    </tr>
    <tr>
      <th>0.75</th>
      <td>67.50</td>
      <td>71.75</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><font color='red'>The median heart rate is lower after colouring (median = 62.00 bpm, q1=61.25, q3=67.50) than after reading (median = 71.0 bpm, q1=66.0, q3=71.75)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span><span class="o">.</span><span class="n">wilcoxon</span><span class="p">(</span><span class="n">heartRate</span><span class="p">[</span><span class="s1">&#39;reading&#39;</span><span class="p">],</span><span class="n">heartRate</span><span class="p">[</span><span class="s1">&#39;colouring&#39;</span><span class="p">],</span><span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;greater&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WilcoxonResult(statistic=50.5, pvalue=0.009765625)
</pre></div>
</div>
</div>
</div>
<p><font color='red'>A sign rank test showed that heart rates were significantly lower after colouring than reading (T=50.5, p=0.00976, n=10 pairs).</p>
<p><font color='red'>We conclude that colouring is effective in lowering heart, rate compared to reading.</p>
<p><strong>f) Assumption of normality</strong></p>
<p><em>The use of the t-test rests on an assumption of normality. For a paired test, it is the <strong>differences</strong> that must be normally distributed for the t-test to be valid</em></p>
<p><em>Can you explain why it is the distribution of the differences, rather than the data, that is important?</em></p>
<p><font color='red'>Because we are testing if the differences are drawn from a normal distribution whose mean is greater than zero. In theory the data could be quite non-normal within each group (eg there is an outlier with high values in both x and y)) but the differences be Normal</p>
<p><em>Let’s check if the distribution of differences is normal:</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">heartRate</span><span class="p">[</span><span class="s1">&#39;diff&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">heartRate</span><span class="o">.</span><span class="n">colouring</span><span class="o">-</span><span class="n">heartRate</span><span class="o">.</span><span class="n">reading</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">heartRate</span><span class="p">[</span><span class="s1">&#39;diff&#39;</span><span class="p">],</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">rugplot</span><span class="p">(</span><span class="n">heartRate</span><span class="p">[</span><span class="s1">&#39;diff&#39;</span><span class="p">],</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/09fb05caeaece06c680c984ae22a6cc84b0e573d510b4c9d587aa370f6246663.png" src="../_images/09fb05caeaece06c680c984ae22a6cc84b0e573d510b4c9d587aa370f6246663.png" />
</div>
</div>
<p><em>It seems not - the differences have a distribution with positive skew (to be fair the sample size is too small to be really confident about this, but if unsure, it is better to avoid assuming normality)</em></p>
<p><strong>g) Which statistical test do you think was the best choice for this dataset?</strong></p>
<p><font color='red'>I would choose the permutation test.</p>
<p><font color='red'>The t-test is not valid (assumption of normality not met as per my graph above; or even without the graph we could say that with a tiny sample size and no a priori reason to this the differences should be normal, we cannot assume normality)</p>
<p><font color='red'>The sign rank test is less powerful than the permutation test as it uses less information</p>
<p><font color='red'>Note - students may make another choice; for example they may prefer the sign rank test as there is one outlier difference; this is OK as long as there is a coherent justification. I am less keen on students choosing the t-test as with the small sample, and lack of a priori reason to this the data should be normal, the assumption of normality is hard to justify.</p>
</section>
</section>
<section id="question-3-reaction-times">
<h2>Question 3: Reaction times<a class="headerlink" href="#question-3-reaction-times" title="Permalink to this heading">#</a></h2>
<p><em>Two participants, A and B, perform a choice reaction time task in which they must press one of two buttons depending on whether a word was a real or made-up word</em></p>
<p><em>The data are provided in the file ChoiceRTs.csv. These are made-up data</em></p>
<p><em>Download the data file and load the data into a Pandas dataframe called ChoiceRTs:</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ChoiceRTs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/jillxoreilly/StatsCourseBook_2024/main/data/ChoiceRTs.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>a) Plot the data</strong></p>
<p><em>Plot the data for each participant in a way that illustrates the distribution of reaction times for each person and allows them to be compared. Two subplots within a single figure would be a good choice here.</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">ChoiceRTs</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;RT: participant A&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">ChoiceRTs</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;RT: participant B&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/294bdd031c7c0c3194b5337f86a369244c62ed6f752d6de100a5aff196ee7635.png" src="../_images/294bdd031c7c0c3194b5337f86a369244c62ed6f752d6de100a5aff196ee7635.png" />
</div>
</div>
<p><font color='red'>Note - two plots placed vertically allow for better comparison than horizontally
X axes ranges should match to allow for direct comparison of the distributions</p>
<p><font color='red'>KDE plot would also be fine here</p>
<p><strong>c) Comment on the plot</strong></p>
<p><font color='red'>Your answer here</p>
<p><font color='red'>Both participants have a multimomdal distribution with the bulk of RTs grouped around 400 ms, but a smaller group of fast RTs (around 200ms) and a few slow RTs (&gt;600 ms)</p>
<p><font color='red'>Participant B seems to be slightly slower in the ‘main’ distribution of RTs aroung 400ms, and also has a higher number of very fast RTs.</p>
<p><strong>d) Data cleaning decision</strong></p>
<p><em>The researcher decides that reaction times under 300ms (very fast responses) and over 700ms (very slow responses) should be excluded.</em></p>
<p><em>Do you think this is justified? Explain your answer.</em></p>
<p><font color='red'>Your answer here</p>
<p><font color='red'>Yes, the RTs below 300ms clearly belong to a separate distribution from the bulk of RTs - maybe they represent false starts. The RTs above 700ms also seem to be outliers (maybe trials on which the participant missed seeing the cue)</p>
<p><font color='red'>Sometimes students feel that no data should ever be excluded, because they are after all real datapoints and it is more honest to include everything. I would refer them back to the lecture on data wrangling; our job as researchers is to separate out data that measure the process of interest from ‘bad’ datapoints that reflect some other process. However, we could also note taht it is important to be trasparent about which data were included (running our analysis in Jupyter Notebooks is ideal for this as every step is recorded, unlike if we had manually remmoved cases from an Excel spreadsheet or similar!)</p>
<p><strong>e) Data cleaning implementation</strong></p>
<p><em>Make a new dataframe called <code class="docutils literal notranslate"><span class="pre">ChoiceRTs_clean</span></code> with the data with RTs outside the range 300-700ms replaced by <code class="docutils literal notranslate"><span class="pre">NaN</span></code></em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create a new dataframe with fast and slow RTs replaced by NaN</span>
<span class="n">ChoiceRTs_clean</span> <span class="o">=</span> <span class="n">ChoiceRTs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">ChoiceRTs_clean</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">ChoiceRTs_clean</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">300</span><span class="p">),[</span><span class="s1">&#39;A&#39;</span><span class="p">]]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">ChoiceRTs_clean</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">ChoiceRTs_clean</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">700</span><span class="p">),[</span><span class="s1">&#39;A&#39;</span><span class="p">]]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">ChoiceRTs_clean</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">ChoiceRTs_clean</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">300</span><span class="p">),[</span><span class="s1">&#39;B&#39;</span><span class="p">]]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">ChoiceRTs_clean</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">ChoiceRTs_clean</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">700</span><span class="p">),[</span><span class="s1">&#39;B&#39;</span><span class="p">]]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="c1"># check it worked - min and max should now be 300,700 or nearby</span>
<span class="n">ChoiceRTs_clean</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>trialNumber</th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>235.000000</td>
      <td>208.000000</td>
      <td>196.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>118.000000</td>
      <td>401.752356</td>
      <td>431.175663</td>
    </tr>
    <tr>
      <th>std</th>
      <td>67.982841</td>
      <td>57.575202</td>
      <td>49.184896</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>310.290000</td>
      <td>304.440000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>59.500000</td>
      <td>364.915000</td>
      <td>397.627500</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>118.000000</td>
      <td>393.430000</td>
      <td>429.060000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>176.500000</td>
      <td>427.362500</td>
      <td>455.457500</td>
    </tr>
    <tr>
      <th>max</th>
      <td>235.000000</td>
      <td>674.130000</td>
      <td>615.340000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>f) Calculate the mean and sd of reaction time</strong></p>
<ul class="simple">
<li><p>before and</p></li>
<li><p>after excluding data outside the range 300-700 ms</p></li>
</ul>
<p><em>Comment on the difference in results</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># stats for original data</span>
<span class="n">ChoiceRTs</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">],</span><span class="s1">&#39;B&#39;</span><span class="p">:[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">]})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>mean</th>
      <td>391.915404</td>
      <td>407.901106</td>
    </tr>
    <tr>
      <th>std</th>
      <td>92.417086</td>
      <td>114.115202</td>
    </tr>
    <tr>
      <th>count</th>
      <td>235.000000</td>
      <td>235.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># stats for cleaned data</span>
<span class="n">ChoiceRTs_clean</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">],</span><span class="s1">&#39;B&#39;</span><span class="p">:[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">]})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>mean</th>
      <td>401.752356</td>
      <td>431.175663</td>
    </tr>
    <tr>
      <th>std</th>
      <td>57.575202</td>
      <td>49.184896</td>
    </tr>
    <tr>
      <th>count</th>
      <td>208.000000</td>
      <td>196.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>g) Statistical test</strong></p>
<p><em>In each case:</em></p>
<p>i)	all the data</p>
<p>ii) the data with RTs outside the range 300-700ms excluded</p>
<p><em>conduct a permutation test to determine whether there is a difference in the mean reaction time between the two participants</em></p>
<p><strong>HINT you will need to replace the function <code class="docutils literal notranslate"><span class="pre">np.mean()</span></code> with <code class="docutils literal notranslate"><span class="pre">np.nanmean()</span></code> as np.mean() returns a NaN if any of the values being averaged are NaN</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># all the data</span>
<span class="k">def</span> <span class="nf">dMeans</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="n">stats</span><span class="o">.</span><span class="n">permutation_test</span><span class="p">((</span><span class="n">ChoiceRTs</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="n">ChoiceRTs</span><span class="o">.</span><span class="n">B</span><span class="p">),</span> <span class="n">dMeans</span><span class="p">,</span> <span class="n">permutation_type</span><span class="o">=</span><span class="s1">&#39;independent&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PermutationTestResult(statistic=-15.985702127659636, pvalue=0.098, null_distribution=array([ -3.00825532,  -2.66485106, -10.91982979, ...,  14.22331915,
         7.30178723, -11.17685106]))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># data with extreme values excluded</span>
<span class="k">def</span> <span class="nf">dMeans</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="n">stats</span><span class="o">.</span><span class="n">permutation_test</span><span class="p">((</span><span class="n">ChoiceRTs_clean</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="n">ChoiceRTs_clean</span><span class="o">.</span><span class="n">B</span><span class="p">),</span> <span class="n">dMeans</span><span class="p">,</span> <span class="n">permutation_type</span><span class="o">=</span><span class="s1">&#39;independent&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PermutationTestResult(statistic=-29.423307496075324, pvalue=0.0002, null_distribution=array([-0.44599784, -2.40132421, -2.26968725, ..., -5.61204813,
       -5.33940594, -2.19543395]))
</pre></div>
</div>
</div>
</div>
<p><strong>h) Comment on the difference in results when outliers are excluded</strong></p>
<p>Comment on the difference in results for the permutation test, with data outside the range 300-700ms omitted or not</p>
<p><font color='red'>Your answer here</p>
<p><font color='red'>Comments - we get a more significant difference when the extreme RTs are omitted. This is because removing extreme values reduces the standard deviation <span class="math notranslate nohighlight">\(s\)</span>, and thus the standard error of the mean for each sample.</p>
</section>
<section id="part-2-more-revision">
<h2>Part 2 - More Revision<a class="headerlink" href="#part-2-more-revision" title="Permalink to this heading">#</a></h2>
<section id="long-vs-wideform-data">
<h3>Long vs wideform data<a class="headerlink" href="#long-vs-wideform-data" title="Permalink to this heading">#</a></h3>
<p><em>Pandas dataframes can be in longform or wideform (definitions <a href='https://www.statology.org/long-vs-wide-data/'>here</a>. We have seen examples of both throughout the term. Let’s check you are comfortable with using both formats.</em></p>
<p><em>Here are same data are provided in longform and wideform:</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">heightsWideform</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/jillxoreilly/StatsCourseBook_2024/main/data/BrotherSisterData.csv&#39;</span><span class="p">)</span>
<span class="n">heightsLongform</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/jillxoreilly/StatsCourseBook_2024/main/data/BrotherSisterDataLongform.csv&#39;</span><span class="p">)</span>
<span class="n">heightsLongform</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>familyID</th>
      <th>sex</th>
      <th>height</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>410119</td>
      <td>Male</td>
      <td>174</td>
    </tr>
    <tr>
      <th>1</th>
      <td>438181</td>
      <td>Male</td>
      <td>183</td>
    </tr>
    <tr>
      <th>2</th>
      <td>260033</td>
      <td>Male</td>
      <td>154</td>
    </tr>
    <tr>
      <th>3</th>
      <td>330754</td>
      <td>Male</td>
      <td>172</td>
    </tr>
    <tr>
      <th>4</th>
      <td>118173</td>
      <td>Male</td>
      <td>172</td>
    </tr>
    <tr>
      <th>5</th>
      <td>218511</td>
      <td>Male</td>
      <td>161</td>
    </tr>
    <tr>
      <th>6</th>
      <td>934515</td>
      <td>Male</td>
      <td>167</td>
    </tr>
    <tr>
      <th>7</th>
      <td>936244</td>
      <td>Male</td>
      <td>172</td>
    </tr>
    <tr>
      <th>8</th>
      <td>608784</td>
      <td>Male</td>
      <td>195</td>
    </tr>
    <tr>
      <th>9</th>
      <td>700114</td>
      <td>Male</td>
      <td>189</td>
    </tr>
    <tr>
      <th>10</th>
      <td>902900</td>
      <td>Male</td>
      <td>161</td>
    </tr>
    <tr>
      <th>11</th>
      <td>327878</td>
      <td>Male</td>
      <td>181</td>
    </tr>
    <tr>
      <th>12</th>
      <td>714099</td>
      <td>Male</td>
      <td>175</td>
    </tr>
    <tr>
      <th>13</th>
      <td>136536</td>
      <td>Male</td>
      <td>170</td>
    </tr>
    <tr>
      <th>14</th>
      <td>483548</td>
      <td>Male</td>
      <td>175</td>
    </tr>
    <tr>
      <th>15</th>
      <td>992816</td>
      <td>Male</td>
      <td>169</td>
    </tr>
    <tr>
      <th>16</th>
      <td>427440</td>
      <td>Male</td>
      <td>169</td>
    </tr>
    <tr>
      <th>17</th>
      <td>809371</td>
      <td>Male</td>
      <td>180</td>
    </tr>
    <tr>
      <th>18</th>
      <td>578843</td>
      <td>Male</td>
      <td>180</td>
    </tr>
    <tr>
      <th>19</th>
      <td>342207</td>
      <td>Male</td>
      <td>180</td>
    </tr>
    <tr>
      <th>20</th>
      <td>565176</td>
      <td>Male</td>
      <td>175</td>
    </tr>
    <tr>
      <th>21</th>
      <td>626851</td>
      <td>Male</td>
      <td>162</td>
    </tr>
    <tr>
      <th>22</th>
      <td>185965</td>
      <td>Male</td>
      <td>175</td>
    </tr>
    <tr>
      <th>23</th>
      <td>165826</td>
      <td>Male</td>
      <td>181</td>
    </tr>
    <tr>
      <th>24</th>
      <td>819334</td>
      <td>Male</td>
      <td>173</td>
    </tr>
    <tr>
      <th>25</th>
      <td>410119</td>
      <td>Female</td>
      <td>172</td>
    </tr>
    <tr>
      <th>26</th>
      <td>438181</td>
      <td>Female</td>
      <td>180</td>
    </tr>
    <tr>
      <th>27</th>
      <td>260033</td>
      <td>Female</td>
      <td>148</td>
    </tr>
    <tr>
      <th>28</th>
      <td>330754</td>
      <td>Female</td>
      <td>180</td>
    </tr>
    <tr>
      <th>29</th>
      <td>118173</td>
      <td>Female</td>
      <td>165</td>
    </tr>
    <tr>
      <th>30</th>
      <td>218511</td>
      <td>Female</td>
      <td>159</td>
    </tr>
    <tr>
      <th>31</th>
      <td>934515</td>
      <td>Female</td>
      <td>159</td>
    </tr>
    <tr>
      <th>32</th>
      <td>936244</td>
      <td>Female</td>
      <td>164</td>
    </tr>
    <tr>
      <th>33</th>
      <td>608784</td>
      <td>Female</td>
      <td>188</td>
    </tr>
    <tr>
      <th>34</th>
      <td>700114</td>
      <td>Female</td>
      <td>175</td>
    </tr>
    <tr>
      <th>35</th>
      <td>902900</td>
      <td>Female</td>
      <td>160</td>
    </tr>
    <tr>
      <th>36</th>
      <td>327878</td>
      <td>Female</td>
      <td>177</td>
    </tr>
    <tr>
      <th>37</th>
      <td>714099</td>
      <td>Female</td>
      <td>168</td>
    </tr>
    <tr>
      <th>38</th>
      <td>136536</td>
      <td>Female</td>
      <td>169</td>
    </tr>
    <tr>
      <th>39</th>
      <td>483548</td>
      <td>Female</td>
      <td>165</td>
    </tr>
    <tr>
      <th>40</th>
      <td>992816</td>
      <td>Female</td>
      <td>164</td>
    </tr>
    <tr>
      <th>41</th>
      <td>427440</td>
      <td>Female</td>
      <td>163</td>
    </tr>
    <tr>
      <th>42</th>
      <td>809371</td>
      <td>Female</td>
      <td>176</td>
    </tr>
    <tr>
      <th>43</th>
      <td>578843</td>
      <td>Female</td>
      <td>176</td>
    </tr>
    <tr>
      <th>44</th>
      <td>342207</td>
      <td>Female</td>
      <td>172</td>
    </tr>
    <tr>
      <th>45</th>
      <td>565176</td>
      <td>Female</td>
      <td>170</td>
    </tr>
    <tr>
      <th>46</th>
      <td>626851</td>
      <td>Female</td>
      <td>157</td>
    </tr>
    <tr>
      <th>47</th>
      <td>185965</td>
      <td>Female</td>
      <td>172</td>
    </tr>
    <tr>
      <th>48</th>
      <td>165826</td>
      <td>Female</td>
      <td>179</td>
    </tr>
    <tr>
      <th>49</th>
      <td>819334</td>
      <td>Female</td>
      <td>171</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>a. Plot the data as a KDE plot (plot brothers and sisters as two separate KDEs)</strong></p>
<p>You might need to look back through the notes for examples of how to do this, or just try a few options to see what works.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here to plot the longform data</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">heightsWideform</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/201d3a4dfab5fe21e8c62492149e0a61a170a37769dbd016d4049519d1845400.png" src="../_images/201d3a4dfab5fe21e8c62492149e0a61a170a37769dbd016d4049519d1845400.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here to plot the wideform data</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">heightsLongform</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;sex&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4a651ffe377a11bb5532370e61e4604690fc2119a344aa461c6d57f6d8ba481f.png" src="../_images/4a651ffe377a11bb5532370e61e4604690fc2119a344aa461c6d57f6d8ba481f.png" />
</div>
</div>
<p><strong>b. Plot the data as a scatterplot of brother vs sister’s height</strong></p>
<p><em>Let’s do this for both longform and wideform data. Let’s use <code class="docutils literal notranslate"><span class="pre">sns.regplot()</span></code> which adds the best fitting regression line (the straight line that best fits through the data points) - and compare to the line x=y</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Wideform version</span>
<span class="c1"># use sns.regplot to make a sctterplot with regression line</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">heightsWideform</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;brother&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sister&#39;</span><span class="p">)</span>

<span class="c1"># add the line x=y as a red dashed line</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">150</span><span class="p">,</span><span class="mi">200</span><span class="p">],[</span><span class="mi">150</span><span class="p">,</span><span class="mi">200</span><span class="p">],</span><span class="s1">&#39;r--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/eb9a74dd08f56007464c131dec2d0369adaa80547a3cac9398b5a0eda5dfebaf.png" src="../_images/eb9a74dd08f56007464c131dec2d0369adaa80547a3cac9398b5a0eda5dfebaf.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Longform version</span>
<span class="c1"># use sns.regplot to make a sctterplot with regression line</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">heightsLongform</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;sex==&quot;Male&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> 
            <span class="n">y</span><span class="o">=</span><span class="n">heightsLongform</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;sex==&quot;Female&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>

<span class="c1"># add the line x=y as a red dashed line</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">150</span><span class="p">,</span><span class="mi">200</span><span class="p">],[</span><span class="mi">150</span><span class="p">,</span><span class="mi">200</span><span class="p">],</span><span class="s1">&#39;r--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/baa5d3b76709e8683b3b7196a967a69c346404085bdb144f91db4881d12b09f4.png" src="../_images/baa5d3b76709e8683b3b7196a967a69c346404085bdb144f91db4881d12b09f4.png" />
</div>
</div>
<p><strong>c. Get the mean height for brothers and sisters separately</strong></p>
<p><em>Do this for the longform and wideform dataframes</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code to get the mean brother and sister heights from the wideform data</span>
<span class="n">heightsWideform</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>brother    173.80
sister     169.16
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code to get the mean brother and sister heights from the wideform data</span>
<span class="c1">#EITHER</span>
<span class="nb">print</span><span class="p">(</span><span class="n">heightsLongform</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;sex==&quot;Male&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">height</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">heightsLongform</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;sex==&quot;Female&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">height</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="c1">#OR</span>
<span class="n">heightsLongform</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;sex&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">height</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>173.8
169.16
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sex
Female    169.16
Male      173.80
Name: height, dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="experimental-design">
<h3>Experimental design<a class="headerlink" href="#experimental-design" title="Permalink to this heading">#</a></h3>
<p><strong>a. Paired design</strong></p>
<p><em>i) What is a <em>paired</em> design (also called a <em>matched-pairs</em> design)?</em></p>
<p><font color='red'>Your answer here</p>
<p><font color='red'>A design in which each member of group A has a ‘pair’ in group B, who is matched on factors that could affect the measure of interest but are irrelevant to the hypothesis (eg we match for genetic or lifestyle factors or disease severity when testing a drug vs placebo)</p>
<p><em>ii) What are the advantages of a paired design (compared to a independent samples design?)</em></p>
<p><font color='red'>Your answer here</p>
<p><font color='red'>By ‘cancelling out’ irrelevant factors we become more sensitive to the relevant factor/ experimental manipulation</p>
<p><em>iii) In a paired design, we are testing whether the average <em>difference</em> withing pairs is significantly different from zero. For example, is the difference between each brother and his own sister reliably positive (brothers are taller than sisters)?</em></p>
<p><em>Look at the scatterplot above. In this case, why is it particularly helpful to use a</em> paired <em>design rather than an independent samples design?</em></p>
<p><font color='red'>Your answer here</p>
<p><font color='red'>A lot of the variance in height is due to the shared effect of familiy, which is irrelevant to our question; the paired design cancels this out.</p>
<p><strong>b) Repeated measures design</strong></p>
<p><em>A <strong>repeated measures</strong> design is a type of paired design.</em></p>
<p><em>i) Explain what is the difference between a paired design (in general) and a repeated measures design.</em></p>
<p><font color='red'>Your answer here</p>
<p><font color='red'>Repeated measures uses the same participants twice, rather than different individuals who were matched in some way</p>
<p><em>ii) Give an example of a study in which a repeated measures design could be used (ie, ‘if we wanted to test xxx, we could use a repeated measures design in which we measure…..’)</em></p>
<p><font color='red'>Your answer here</p>
<p><font color='red'>e.g. if we want to test the effect of a drug on blood pressure, we measure blood pressure in the same person on- and off- drug</p>
<p><em>iii) What potential pitfalls are there with repeated measures designs? How might they be mitigated?</em></p>
<p><font color='red'>Your answer here</p>
<p><font color='red'>Order effects. Need to counterbalance order of conditions.</p>
<p><strong>d) Detailed example</strong></p>
<p><em>A researcher hypothesises that men are taller than women:</em></p>
<p><span class="math notranslate nohighlight">\(\mathcal{H_o}\)</span>: the mean height of men is equal to that of women</p>
<p><span class="math notranslate nohighlight">\(\mathcal{H_a}\)</span>: the mean height of men is greater than that of women</p>
<p><em>She conducts two permutation tests on the brother-sister data as follows:</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TEST 1:</span>
<span class="k">def</span> <span class="nf">dMeans</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="n">results1</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">permutation_test</span><span class="p">((</span><span class="n">heightsWideform</span><span class="o">.</span><span class="n">brother</span><span class="p">,</span> <span class="n">heightsWideform</span><span class="o">.</span><span class="n">sister</span><span class="p">),</span> 
                                   <span class="n">dMeans</span><span class="p">,</span> <span class="n">permutation_type</span><span class="o">=</span><span class="s1">&#39;independent&#39;</span><span class="p">)</span>
<span class="n">results1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PermutationTestResult(statistic=4.640000000000015, pvalue=0.0822, null_distribution=array([ 0.72, -2.08,  1.12, ...,  0.16, -0.48,  3.6 ]))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TEST 2:</span>
<span class="k">def</span> <span class="nf">mDiff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">)</span>

<span class="n">results2</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">permutation_test</span><span class="p">((</span><span class="n">heightsWideform</span><span class="o">.</span><span class="n">brother</span><span class="p">,</span> <span class="n">heightsWideform</span><span class="o">.</span><span class="n">sister</span><span class="p">),</span> 
                                   <span class="n">dMeans</span><span class="p">,</span> <span class="n">permutation_type</span><span class="o">=</span><span class="s1">&#39;samples&#39;</span><span class="p">)</span>
<span class="n">results2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PermutationTestResult(statistic=4.640000000000015, pvalue=0.0002, null_distribution=array([ 0.64, -0.96, -1.44, ..., -0.8 ,  0.08,  2.48]))
</pre></div>
</div>
</div>
</div>
<p><strong>i) Which test was correct and why?</strong></p>
<p><font color='red'>Your answer here</p>
<p><font color='red'>Test 2 as it is a paired test</p>
<p><strong>ii) The p-value for Test 2 is smaller, why?</strong></p>
<p><font color='red'>Your answer here</p>
<p><font color='red'>In test 1 we didn’t make use of the paired nature of the data, therefore between-families variation was not controlled for</p>
<p><strong>iii) In each case we specify a function to get the difference of means - what is the difference between <code class="docutils literal notranslate"><span class="pre">dMeans()</span></code> and <code class="docutils literal notranslate"><span class="pre">mDiff()</span></code>?</strong></p>
<p><font color='red'>Your answer here</p>
<p><font color='red'>mDiff gets the mean difference within each pair and averages those differences; dMeans gets the mean for each group and finds the difference</p>
<p><strong>iv) The Test Statistic is the same for tests 1 and 2. Can you explain why?</strong></p>
<p><font color='red'>Your answer here</p>
<p><font color='red'>The mean difference is the same as the difference of means for any given dataset</p>
<p><strong>v) The null distribution for tests 1 and 2 is quite different. Can you explain why?</strong></p>
<p>The null distributions are plotted for you here to help:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">results1</span><span class="o">.</span><span class="n">null_distribution</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;difference of group means&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">results2</span><span class="o">.</span><span class="n">null_distribution</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;mean pairwise difference&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2689532bdb9cbb07d46e353949021bfd05374f74f0411bdd646bd0328b781288.png" src="../_images/2689532bdb9cbb07d46e353949021bfd05374f74f0411bdd646bd0328b781288.png" />
</div>
</div>
<p><font color='red'>Your answer here</p>
<p><font color='red'>For the paired test the range of possible values of mDiff is smaller; the maximum would be if every brother was taller than his sister (even so the height difference within families is not that great).</p>
<p><font color='red'>For the unpaired test a greater range of dMeans is possible; the maximum would be if all the men were taller than all the women. This would be quite a bibg difference as the tallest people/fammilies are a lot taller than the shortest people/families.</p>
</section>
<section id="one-vs-two-tailed-tests">
<h3>One vs Two-tailed tests<a class="headerlink" href="#one-vs-two-tailed-tests" title="Permalink to this heading">#</a></h3>
<p><em>If we know the direction in which we expect an effect (men are taller than women) we can run a one-tailed test. Otherwise we must run a two-tailed test.</em></p>
<p><em>Load the following (made-up) data comparing the heights of female Psychology and female BMS students:</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">heights</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/jillxoreilly/StatsCourseBook_2024/main/data/PsyBMSheights.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><em>A researcher hypothesises that BMS students are taller than psychology students. She limits her analysis to female students:</em></p>
<p><span class="math notranslate nohighlight">\(\mathcal{H_o}\)</span> The mean height of (female) psychology and BMS students are the same</p>
<p><span class="math notranslate nohighlight">\(\mathcal{H_a}\)</span> The mean height of (female) psychology students is less than the mean height of BMS students</p>
<p><em>She decides to test at the <span class="math notranslate nohighlight">\(\alpha=0.05\)</span> level</em></p>
<p><strong>a) Is this a one or two tailed test?</strong></p>
<p><font color='red'>Your answer here</p>
<p><font color='red'>One because the direction is specified</p>
<p><strong>b) What’s wrong in the following example?</strong></p>
<p>The researcher used a t-test to test her hypothesis as follows</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">heights</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;subject==&quot;BMS&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="n">heights</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;subject==&quot;Psychology&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;less&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TtestResult(statistic=1.823852779167176, pvalue=0.9627982812018988, df=48.0)
</pre></div>
</div>
</div>
</div>
<p>What has she done wrong?</p>
<p><font color='red'>Your answer here</p>
<p><font color='red'>She has done a one tailed test in the wrong direction, testing for BMS less than PSY</p>
<p><font color='red'>This is a common error so if you ever get a p value of 0.95 or so check that you haven’t done this!</p>
<p><strong>c) Correct the mistake</strong></p>
<p><em>Re-run the test, correcting the researcher’s mistake</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
<span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">heights</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;subject==&quot;BMS&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="n">heights</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;subject==&quot;Psychology&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;greater&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TtestResult(statistic=1.823852779167176, pvalue=0.03720171879810118, df=48.0)
</pre></div>
</div>
</div>
</div>
<p><strong>d) Run a two-tailed test</strong></p>
<p><em>Say the researcher had no a-priori hypothesis about which subject hahs taller students. Then she should have stated her hypotheses as follows, and run a two-tailed test</em></p>
<p><span class="math notranslate nohighlight">\(\mathcal{H_o}\)</span> The mean height of (female) psychology and BMS students are the same</p>
<p><span class="math notranslate nohighlight">\(\mathcal{H_o}\)</span> The mean height of (female) psychology students is different from mean height of BMS students</p>
<p><em>She still wishes to test at the <span class="math notranslate nohighlight">\(\alpha=0.05\)</span> level</em>*</p>
<p><strong>Run the test yourself</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
<span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">heights</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;subject==&quot;BMS&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="n">heights</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;subject==&quot;Psychology&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TtestResult(statistic=1.823852779167176, pvalue=0.07440343759620235, df=48.0)
</pre></div>
</div>
</div>
</div>
<p><em>i) How does the <span class="math notranslate nohighlight">\(p\)</span>-value from the two tailed test relate to that of (correct version of) the one-tailed test above?</em></p>
<p><font color='red'>Your answer here</p>
<p><font color='red'>The value for the two-tailed test is double that for the one tailed test because we could the area in the ‘tail’ at both ends of the null distribution</p>
<p><em>ii) The two-tailed test is not significant at the 5% level whilst the one-tailed test was significant. Can you explain why?</em></p>
<ul class="simple">
<li><p>Key terms for your answer are the <em>critical region</em> of the test and the <em>critical value</em> or <em>cut-off value</em></p></li>
<li><p>These were introduced in lectures but if you don’t remember them, a quick good brings up several tutorials</p></li>
</ul>
<p><font color='red'>In the two-tailed test the critical region is shared between obth tails of the null distribution (each get 2.5%) so the critical or cutoff value needs to be more extreme. Thus the two-tailed test uses a harsher or momre stringent criterion for rejecting the null than in the one-tailed test (but will find a significant result if either group has a larger mean, not just one direction).</p>
<p><strong>e) “Peeking”</strong></p>
<p><em>Why did the researcher think that BMS students would be taller in the first place? Because when she plotted the data to check for outliers (which is indeed correct procedure), she noticed that the BMS students looked taller:</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">heights</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;subject&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/545387d1eedaedd91d1f7681b742524c6ff9cf05c78f3e09fbfd02abdc15eeca.png" src="../_images/545387d1eedaedd91d1f7681b742524c6ff9cf05c78f3e09fbfd02abdc15eeca.png" />
</div>
</div>
<p>If the psychology students had looked taller, she would have done a one-tailed test in the other direction.</p>
<p>Using this approach (sometiems called “peeking” at the data) is wrong, because means that the chance of getting a ‘significant’ result if the null was true (the false positive rate) is double.</p>
<p>Can you explain why?</p>
<p><font color='red'>Your answer here</p>
<p><font color='red'>We effectively now have a 5% critical region at each tail of the null distribution (as we would have picked whichever tail looked more likely to ‘work’) - so the total critical region is 10%</p>
<p><em>It is not wrong to inspect your data before running a test, but <strong>your hypotheses (and in particular justification for a one-tailed test) should reflect predictions you would be able to make without seeing the particular sample of data</strong>.</em></p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Chapter6_ttest"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Vacation Assignment</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#part-1-data-analysis-exercises">Part 1 - data analysis exercises</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#question-1-cloud-seeding">Question 1 - Cloud seeding</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-red-i-independent-samples-t-test"><font color="red">I. Independent samples t-test</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-red-ii-permutation-test-for-difference-of-means-independent-samples"><font color="red">II. Permutation test for difference of means (independent samples)</font></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#question-2-colouring-books">Question 2: Colouring books</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-red-i-paired-samples-t-test"><font color="red">I. Paired samples t-test</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-red-ii-permutation-test-for-difference-of-means-paired-samples"><font color="red">II. Permutation test for difference of means: paired samples</font></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#font-color-red-iii-sign-rank-test"><font color="red">III. Sign rank test</font></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#question-3-reaction-times">Question 3: Reaction times</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-2-more-revision">Part 2 - More Revision</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#long-vs-wideform-data">Long vs wideform data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#experimental-design">Experimental design</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#one-vs-two-tailed-tests">One vs Two-tailed tests</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jill O'Reilly & Lindsay Richards
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>